# ADR-001: Choice of Scheduler for Background Jobs

**Status**: Accepted  
**Date**: 2025-06-08  
**Author**: Valeriia Huza

---

## Context

Our weather subscription service needs to perform **periodic background task**:

- Sending weather update emails based on user-defined frequency (daily/hourly, potentially more complex frequency in the future)

The scheduler must be **reliable and performant**, ensuring that users receive their updates with at least **99.9% success rate**.

---

## Options Considered

### 1. `robfig/cron`

**Pros:**

- Precise scheduling using cron syntax (e.g., `"0 8 * * *"`)
- Simple and clean API
- Widely used and actively maintained
- Supports time zones

**Cons:**

- In-memory only: if the application restarts, scheduled jobs are lost

---

### 2. `go-co-op/gocron`

**Pros:**

- Human-readable, chainable and easy API (e.g., `.Every(1).Day().At("10:00")`)
- Lightweight and beginner-friendly

**Cons:**

- Less powerful for complex scheduling
- Newer than `robfig/cron`

---

### 3. `time.Ticker` (Standard Library)

**Pros:**

- No external dependencies
- Very lightweight
- Suitable for a single job

**Cons:**

- No support for time zones
- Not scalable for multiple independent jobs
- More boilerplate

---

## Decision

I chose **`robfig/cron`** as the scheduling mechanism for background jobs.

---

## Consequences

### ✅ Positive

- Reliable scheduling with precise cron expressions
- Flexible job configuration
- Scales well with increasing system complexity
- No external dependencies or services required (no need for Redis, Cloud Tasks, etc.)

### ❌ Negative

- In-memory scheduling only — jobs are lost on app restart
- Debugging and monitoring are manually
- No built-in retry mechanism — failures need to be handled within each job